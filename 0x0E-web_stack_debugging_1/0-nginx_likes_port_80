#!/usr/bin/env bash

# Install net-tools if not installed
if [ -z "$(command -v netstat)" ]; then
    sudo apt-get update
    sudo apt-get install -y net-tools
fi

# Check if Nginx is running
if sudo service nginx status | grep -q "active (running)"; then
    echo "Nginx is running."
else
    echo "Nginx is not running. Starting Nginx..."
    sudo service nginx start
fi

# Check if Nginx is listening on port 80
if netstat -tuln | grep -q ":80"; then
    echo "Nginx is listening on port 80."
else
    echo "Nginx is not listening on port 80. Configuring..."
    # Add Nginx configuration to listen on port 80 for all active IPv4 IPs
    echo -e "server {
\n\tlisten 80;\n\tserver_name _;\n\tlocation / {
\n\t\treturn 200 'Hello, Nginx!';\n\t}\n}" | sudo tee /etc/nginx/sites-available/default > /dev/null
    # Restart Nginx to apply changes
    sudo service nginx restart
    echo "Nginx configured to listen on port 80 for all active IPv4 IPs."
fi
